import {
  IUILibsService,
  IUILibRawRecord,
  IUILibMinifiedRecord,
  IUILibID,
} from './types';
import RAW_DB from './db.json';

/* ************************************************************************************************
 *                                         IMPLEMENTATION                                         *
 ************************************************************************************************ */
const UILibsServiceFactory = (): IUILibsService => {
  /* **********************************************************************************************
   *                                          PROPERTIES                                          *
   ********************************************************************************************** */

  // copy of the raw database
  const __DB = <IUILibRawRecord[]>RAW_DB;





  /* **********************************************************************************************
   *                                         MISC HELPERS                                         *
   ********************************************************************************************** */

  /**
   * Builds the path for a library's logo
   * @param id
   * @returns string
   */
  const __buildLogoPath = (id: IUILibID): string => `ui-libs-logos/${id}.png`;





  /* **********************************************************************************************
   *                                          RETRIEVERS                                          *
   ********************************************************************************************** */

  /**
   * Retrieves the list of minified records
   * @returns IUILibMinifiedRecord[]
   */
  const getMinifiedRecords = (): IUILibMinifiedRecord[] => (
    __DB.map((record) => ({ id: record.id, name: record.name, logo: __buildLogoPath(record.id) }))
  );





  /* **********************************************************************************************
   *                                         MODULE BUILD                                         *
   ********************************************************************************************** */
  return Object.freeze({
    // properties
    // ...

    // retrievers
    getMinifiedRecords,
  });
};





/* ************************************************************************************************
 *                                        GLOBAL INSTANCE                                         *
 ************************************************************************************************ */
const UILibsService = UILibsServiceFactory();





/* ************************************************************************************************
 *                                         MODULE EXPORTS                                         *
 ************************************************************************************************ */
export {
  UILibsService,
};
